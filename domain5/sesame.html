<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SESAME Authentication Flow - Domain 5 - Alex Cyber Study</title>
  <link rel="stylesheet" href="../style.css">
  <style>
    .sesame-layout{display:grid;grid-template-columns:280px 1fr 1fr;gap:1.5rem;max-width:1200px;margin:0 auto}.ref-panel{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.1);border-radius:14px;padding:1.25rem}.ref-panel h3{text-align:center;font-size:1.05rem;margin-bottom:1rem}.ref-table{width:100%;font-size:.82rem;border-collapse:collapse}.ref-table th,.ref-table td{text-align:left;padding:.5rem .4rem;border-bottom:1px solid rgba(255,255,255,0.08)}.ref-table th{color:rgba(255,255,255,0.5);font-weight:600}.ref-table td:first-child{color:#60a5fa;font-weight:700;white-space:nowrap}.flow-column{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.1);border-radius:14px;padding:1.25rem}.flow-column h3{text-align:center;font-size:1.05rem;margin-bottom:1rem}.flow-step{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:.85rem 1rem;margin:.5rem 0;border-radius:10px;cursor:grab;font-weight:600;font-size:.95rem;user-select:none;transition:transform .2s,box-shadow .2s;box-shadow:0 3px 10px rgba(0,0,0,0.2)}.flow-step:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,0.3)}.flow-step.dragging{opacity:.4}.flow-slot{background:rgba(255,255,255,0.03);border:2px dashed rgba(255,255,255,0.15);padding:.85rem 1rem;margin:.5rem 0;border-radius:10px;min-height:44px;transition:all .2s;position:relative}.flow-slot.drag-over{background:rgba(102,126,234,0.15);border-color:#667eea}.flow-slot .flow-step{margin:0}.flow-slot.correct{background:rgba(34,197,94,0.15);border-color:#22c55e;border-style:solid}.flow-slot.correct .flow-step{background:linear-gradient(135deg,#22c55e,#16a34a);cursor:default}.flow-slot.incorrect{background:rgba(239,68,68,0.15);border-color:#ef4444;border-style:solid}.flow-slot.incorrect .flow-step{background:linear-gradient(135deg,#ef4444,#dc2626)}.slot-number{position:absolute;top:-8px;left:10px;background:#334155;color:#fff;font-size:.7rem;font-weight:700;padding:1px 8px;border-radius:999px}@media(max-width:900px){.sesame-layout{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <nav>
    <div class="nav-inner">
      <a class="logo" href="../index.html"><span class="logo-icon">üõ°Ô∏è</span> Alex Cyber Study</a>
      <ul class="nav-links">
        <li><a href="../index.html">Home</a></li><li><a href="../domain1/index.html">D1</a></li><li><a href="../domain2/index.html">D2</a></li><li><a href="../domain3/index.html">D3</a></li><li><a href="../domain4/index.html">D4</a></li><li><a href="../domain5/index.html" class="active">D5</a></li><li><a href="../domain6/index.html">D6</a></li><li><a href="../domain7/index.html">D7</a></li><li><a href="../domain8/index.html">D8</a></li>
      </ul>
    </div>
  </nav>
  <div class="game-container">
    <div class="game-header"><h1>üîê SESAME Authentication Flow</h1><p class="game-subtitle">Arrange the SESAME steps in the correct order</p></div>
    <div class="game-controls"><a href="index.html" class="back-btn">‚Üê Back to Domain 5</a><button class="reset-btn" onclick="initSesame()">üîÄ Shuffle</button><button class="reset-btn" style="background:linear-gradient(135deg,#22c55e,#16a34a);" onclick="checkSesame()">‚úÖ Check Answers</button></div>
    <div class="score-display">Placed: <span id="score">0</span> / <span id="total">8</span></div>
    <div class="completion-message" id="completionMessage">üéâ Perfect! SESAME mastered! üéâ</div>
    <div class="sesame-layout">
      <div class="ref-panel"><h3>üìö SESAME Acronyms</h3><table class="ref-table"><tr><th>Acronym</th><th>Meaning</th></tr><tr><td>SESAME</td><td>Secure European System for Applications in a Multivendor Environment</td></tr><tr><td>TTP</td><td>Trusted Third Party</td></tr><tr><td>AS</td><td>Application Server</td></tr><tr><td>SK</td><td>Session Key</td></tr><tr><td>Ticket</td><td>Encrypted credential issued by TTP</td></tr><tr><td>MA</td><td>Mutual Authentication</td></tr></table></div>
      <div class="flow-column"><h3>üß© Steps</h3><div id="stepsContainer"></div></div>
      <div class="flow-column"><h3>üìê Correct Order</h3><div id="slotsContainer"></div></div>
    </div>
  </div>
  <footer><p><a href="index.html">‚Üê Back to Domain 5 Games</a></p></footer>
  <script>
    const correctOrder=["üßë‚Äçüíª Client requests authentication service","üè¢ Authentication Server (SESAME TTP) verifies client","üîë Session key generated by SESAME","üé´ Ticket encrypted with server's secret key","üì° Client presents ticket to Application Server","üóÑÔ∏è Application Server decrypts ticket","ü§ù Mutual authentication established","üîê Secure session begins"];let draggedStep=null;
    function initSesame(){const s=document.getElementById('stepsContainer'),sl=document.getElementById('slotsContainer');s.innerHTML='';sl.innerHTML='';document.getElementById('score').textContent='0';document.getElementById('completionMessage').style.display='none';[...correctOrder].sort(()=>Math.random()-0.5).forEach(t=>{const d=document.createElement('div');d.className='flow-step';d.textContent=t;d.draggable=true;d.dataset.step=t;d.addEventListener('dragstart',()=>{draggedStep=d;d.classList.add('dragging')});d.addEventListener('dragend',()=>d.classList.remove('dragging'));d.addEventListener('touchstart',tS,{passive:false});d.addEventListener('touchmove',tM,{passive:false});d.addEventListener('touchend',tE,{passive:false});s.appendChild(d)});correctOrder.forEach((_,i)=>{const slot=document.createElement('div');slot.className='flow-slot';slot.dataset.index=i;const n=document.createElement('span');n.className='slot-number';n.textContent=`Step ${i+1}`;slot.appendChild(n);slot.addEventListener('dragover',e=>{e.preventDefault();slot.classList.add('drag-over')});slot.addEventListener('dragleave',()=>slot.classList.remove('drag-over'));slot.addEventListener('drop',e=>{e.preventDefault();slot.classList.remove('drag-over');dropOn(slot)});sl.appendChild(slot)})}
    function dropOn(slot){if(!draggedStep)return;const ex=slot.querySelector('.flow-step');if(ex){document.getElementById('stepsContainer').appendChild(ex);ex.draggable=true}slot.classList.remove('correct','incorrect');slot.appendChild(draggedStep);draggedStep=null;document.getElementById('score').textContent=document.querySelectorAll('.flow-slot .flow-step').length}
    function checkSesame(){let ok=true;document.querySelectorAll('.flow-slot').forEach((s,i)=>{const st=s.querySelector('.flow-step');s.classList.remove('correct','incorrect');if(st&&st.dataset.step===correctOrder[i]){s.classList.add('correct');st.draggable=false}else if(st){s.classList.add('incorrect');ok=false}else ok=false});if(ok&&document.querySelectorAll('.flow-slot .flow-step').length===8){document.getElementById('completionMessage').style.display='block';lC()}}
    function lC(){const c=['#4ade80','#f472b6','#60a5fa','#facc15','#a78bfa','#fb923c'];for(let i=0;i<80;i++){const d=document.createElement('div');d.style.cssText=`position:fixed;width:8px;height:8px;border-radius:50%;background:${c[Math.floor(Math.random()*c.length)]};left:${50+(Math.random()-0.5)*30}%;top:-10px;z-index:9999;pointer-events:none;`;document.body.appendChild(d);const x=(Math.random()-0.5)*600,y=window.innerHeight+50,dur=1200+Math.random()*800;d.animate([{transform:'translate(0,0) scale(1)',opacity:1},{transform:`translate(${x}px,${y}px) scale(0.3)`,opacity:0}],{duration:dur,easing:'cubic-bezier(.25,.46,.45,.94)'});setTimeout(()=>d.remove(),dur)}}
    let tc=null,te=null;function tS(e){e.preventDefault();te=e.target.closest('.flow-step');if(!te||!te.draggable)return;draggedStep=te;te.classList.add('dragging');tc=te.cloneNode(true);tc.style.cssText=`position:fixed;z-index:10000;pointer-events:none;opacity:0.85;width:${te.offsetWidth}px;`;document.body.appendChild(tc);mv(e.touches[0])}function tM(e){e.preventDefault();if(!tc)return;mv(e.touches[0]);const el=document.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);document.querySelectorAll('.flow-slot').forEach(s=>s.classList.remove('drag-over'));if(el){const z=el.closest('.flow-slot');if(z)z.classList.add('drag-over')}}function tE(e){if(!tc)return;tc.remove();tc=null;if(te)te.classList.remove('dragging');const t=e.changedTouches[0],el=document.elementFromPoint(t.clientX,t.clientY);document.querySelectorAll('.flow-slot').forEach(s=>s.classList.remove('drag-over'));if(el){const z=el.closest('.flow-slot');if(z)dropOn(z)}te=null}function mv(t){if(!tc)return;tc.style.left=(t.clientX-tc.offsetWidth/2)+'px';tc.style.top=(t.clientY-30)+'px'}
    initSesame();
  </script>
</body>
</html>
